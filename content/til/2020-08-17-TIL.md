---
layout: TIL
title: "2020-08-17-TIL"
template: "til"
date: "2020-08-17"
description: 
---

## Fact

- 14일차

## Feelings

- 오늘 좀 너무 막했다 ㅋㅋ...

## Findings

### IPv4, IPv6

- 인터넷 프로토콜 주소는 IP 주소로도 알려져 있다. 통신에 IP를 사용하는 컴퓨터 네트워크에 연결된 각각의 장치에 할당되는 숫자 라벨이다.
- IP 주소는 특정 네트워크에서 특정 시스템의 식별자 역할을 한다. IP주소를 IP번호와 인터넷주소라고도 한다. IP 주소는 주소 지정과 패킷 구성의 기술적 형식을 지정한다. 대부분의 네트워크는 IP와 TCP(Transmission Control Protocol)를 결합한다. 또한 대상과 소스 간의 가상 연결을 개발할 수 있다. 
- IPv4는 40억 개 이상의 주소인 2^32 주소를 저장할 수 있는 32비트 주소 체계를 사용한다. 현재까지, 제일 많이 사용되는 인터넷 프로토콜로 간주되고 인터넷 트래픽의 94%를 차지한다.
- IPv6는 더 많은 인터넷 주소의 필요성을 충족시키기 위해 배치되고 있다. IPv4에 관련된 문제를 해결하기 위한 것이었다. 128비트 주소공간으로 340억의 고유 주소공간을 허용한다. IPv6은 IPng(Internet Protocol next generation)라고도 한다.
- 차이점
  - IPv4는 32비트 IP 주소인 반면 IPv6은 128비트 IP 주소다.
  - IPv4는 숫자 주소 지정 방법이고 IPv6은 영숫자 주소 지정 방법이다.
  - IPv4 바이너리 비트는 점(.)으로 구분되는 반면 IPv6 바이너리 비트는 콜론(:)으로 구분된다.
  - IPv4는 12개의 헤더 필드를 제공하는 반면 IPv6은 8개의 헤더 필드를 제공한다.
  - IPv4는 브로드캐스트를 지원하는 반면 IPv6은 브로드캐스트를 지원하지 않는다.
  - IPv4에는 체크섬 필드가 있고 IPv6에는 체크섬 필드가 없음
  - IPv4는 VLSM(Virtual Length Subnet Mask)을 지원하는 반면 IPv6은 VLSM을 지원하지 않는다.
  - IPv4는 ARP(Address Resolution Protocol)를 사용하여 MAC 주소에 매핑하는 반면, IPv6은 NDP(Neighbour Discovery Protocol)를 사용하여 MAC 주소에 매핑한다.

[출처](https://www.guru99.com/difference-ipv4-vs-ipv6.html)

![](https://t1.daumcdn.net/cfile/tistory/2270873B5715D31315)

### 서브넷(서브네터워크)

- 커다란 네트워크를 몇개의 네트워크로 작게 분할하는것.
- 호스트 번호의 비트를 서브넷 번호와 호스트 번호로 분할하는것.
  - 호스트 번호의 일부를 줄여서 서브넷 번호를 만드는 것이다.
- 거대한 네트워크를 작은 내트워크로 분할해서 관리 하기 위해서 만든 기능

- 서브넷팅은 기본적으로 TCP/IP 네트워크를 더 작고 관리하기 쉬운 조각으로 나누는 방법이다. 
- 네트워크에 흐르는 과도한 양의 트래픽이 있다면, 그 트래픽이 네트워크를 느리게 실행하게 할 수 있다다.
- 네트워크를 서브넷으로 연결하면 네트워크를 별도의 상호 연결된 네트워크로 분할하는 것이다. 그렇게 하면, 대부분의 네트워크 트래픽은 시작된 서브넷안에서 고립될 것이다.

#### 서브넷 장점

1. 네트워크 성능 및 속도 향상

하나의 브로드캐스트 패킷은 각각의 장치가 네트워크에 진입점을 가지고 있기 때문에 그 네트워크에 연결된 모든 장치에 도달하는 정보를 송신한다. 그러나 다수의 진입점은 네트워크 전체 성능뿐만 아니라 인터넷 작업 전환 장치 성능에 부정적인 영향을 미칠 수 있다.

브로드캐스트 패킷의 또 다른 문제는 네트워크 내의 모든 장치, 심지어 관련이 없는 장치까지도 스팸을 보낼 수 있다는 것이며, 이로 인해 네트워크의 용량이 제한되어 붕괴될 수 있다는 것이다.

그러나 서브넷을 사용하면 정보가 서브넷 네트워크 또는 브로드캐스트 도메인에 남아 있는지 확인할 수 있으며, 이로 인해 다른 서브넷이 속도와 효율성을 최대화할 수 있다. 서브넷팅은 또한 네트워크의 브로드캐스트 도메인을 분할하여 트래픽 흐름을 더 잘 제어할 수 있게 하여 네트워크 성능을 향상시킨다!

 주의점은 트래픽을 서브넷에서 서브넷으로 이동하는 대신 트래픽을 단일 서브넷으로 제한하는 것이 좋다. 따라서 서브넷 간의 트래픽 흐름을 제어하는 것과 함께 가능하면 서브넷의 장치 수를 제한하십시오. 이렇게 하면 네트워크의 속도와 성능이 향상된다.

2. 네트워크 혼잡 감소

서브넷팅은 서브넷 내의 장치로 향하는 트래픽이 해당 서브넷에 머무르도록 보장하여 정체를 감소시킨다. 서브넷의 전략적 배치를 통해 네트워크의 부하를 줄이고 트래픽을 보다 효율적으로 라우팅할 수 있다.

그렇다면, 서브넷이 없는 큰 네트워크는 어떻게 될까? 모든 컴퓨터는 네트워크의 모든 컴퓨터와 서버에서 브로드캐스트 패킷을 볼 수 있고, 그로 인해 스위치는 모든 트래픽을 적절한 포트로 이동시켜야 한다. 이는 정체 증가, 네트워크 성능 저하, 응답 시간 저하를 초래한다.

그러나 라우터를 사용하여 서브넷 간에 트래픽을 이동하면 브로드캐스트 트래픽이나 라우팅할 필요가 없는 정보가 다른 서브넷으로 이동되지 않게 된다. 각 서브넷 내의 트래픽 양이 줄어들기 때문에 각 서브넷의 속도가 증가하여 네트워크 혼잡을 완화한다.

3. 네트워크 보안 강화

네트워크를 서브넷으로 분할하여 ACL, QoS 또는 라우트맵을 사용하여 트래픽 흐름을 제어할 수 있으므로 위협을 식별하고 진입 지점을 닫으며 응답을 보다 쉽게 대상으로 지정할 수 있다.

라우터와 스위치의 ACL 구성을 통해 라우터를 사용하여 네트워크를 분할할 수도 있다. 결과적으로, 서브넷의 장치는 전체 네트워크에 접속할 수 없다.

또 다른 옵션은 무선 클라이언트의 리소스에 대한 액세스를 제한하여 귀중한 정보가 원격 위치에서 쉽게 액세스되지 않도록 하는 것이다.

4. 네트워크 성장 제어

네트워크를 계획하고 설계할 때 네트워크 크기를 고려해야 한다. 서브넷팅의 주요 이점 중 하나는 네트워크 확장을 제어할 수 있다는 것이다.

인기 있는 호스트 공식을 사용하여 네트워크 크기를 결정할 수 있다. 2진수로 변환할 때 서브넷 마스크에 있는 0의 수를 선택하고, 2를 해당 숫자의 전원으로 선택한 다음 - 2를 뺀 다음, 해당 서브넷 마스크에 대해 가능한 호스트 수를 얻으십시오. 그것은 다소 황당했으므로, 호스트 공식에 대해 좀 더 심도 있게 설명하겠다.

다음 단계는 네트워크의 예상 성장을 파악하는 것인데, 대부분의 경우 네트워크의 예상 성장률은 건물의 물리적 크기에 크게 기초하게 될 것이다. 예를 들어 필요한 장치 수가 안정적으로 유지될 것인가, 아니면 결국 두 배가 될 수 있을 것인가? 만일 그렇다면, 네트워크에 적절한 IP 주소 공간을 결정하기 위해서 호스트 수식에 대한 방정식을 적절히 조정해야 할 것이다.

5. 쉬운 행정

네트워크 관리자 입장에서 서브넷팅은 네트워크 관리를 훨씬 쉽게 만들 수 있다. 서브넷을 통해 IP 주소 클래스의 제한과 달리 논리적 호스트 제한이 더 많은 네트워크를 만들 수 있다. 클래스 A의 경우 8비트, 클래스 B의 경우 16비트, 클래스 C의 경우 24비트. 이렇게 생각해 보십시오. 만약 인터넷이 그 세 가지 등급으로만 제한되었다면, 모든 네트워크는 호스트 디바이스의 IP 주소를 254, 64,000 또는 1600만 개밖에 갖지 못했을 겁니다.

서브넷이 없는 경우, 254개 이상의 장치를 가진 네트워크는 수천 개의 IP 주소를 낭비할 수 있는 클래스 B 할당을 필요로 한다. 서브넷을 통해 하위 네트워크에 있는 비트 수를 선택하여 보다 현실적인 호스트 제한을 만들 수 있다.

서브넷팅은 네트워크의 컴퓨터를 감시하는 효과적인 방법이기도 하며, 이는 문제가 발생할 경우 주의가 필요한 컴퓨터를 결정하는 데 도움이 될 수 있다. 따라서 그들은 신중한 계획과 구현을 취하지만, 서브넷화된 네트워크는 일반적으로 관리 및 문제 해결이 더 쉽다.

[출처](https://searchnetworking.techtarget.com/feature/Subnetting-to-increase-performance)


### 공인ip 내부ip

- 인터넷 사용자의 로컬 네트워크를 식별하기 위해 ISP(인터넷 서비스 공급자)가 제공하는 IP 주소이다. 공용 IP 주소라고도 불리며 **외부에 공개되어 있는 IP 주소**이다.

- 공인 IP는 전세계에서 **유일한** IP 주소를 갖는다.

- 공인 IP 주소가 **외부에 공개**되어 있기에 인터넷에 연결된 다른 PC로부터의 **접근이 가능**하다.

- 가정, 회사, 특정기관 내에 할당된 네트워크의 IP 주소이며, 로컬 IP, 가상 IP라고도 한다. 

- IPv4의 주소부족으로 인해 서브넷팅된 IP이기 때문에 라우터에 의해 로컬 네트워크상의 PC 나 장치에 할당된다.

![](https://media.vlpt.us/post-images/noyo0123/d48baef0-f353-11e9-82fb-f1a0dfd61574/image.png)

- 사설 IP를 할당받은 인터넷 접속이 된 장치가 데이터 패킷을 인터넷으로 전송하면, 라우터(공유기)가 해당 사설 IP를 공인 IP로 바꿔서 전송한다.

- 인터넷에서 오는 데이터 패킷의 목적지도 해당하는 사설 IP로 변경한 후 알 맞은 장치에 전송한다.

- 재 IANA(Internet Assigned Numbers Authority)에서 전세계의 IP 주소를 관리하고 있지만, 업무량 분산과 보다 효율적인 운영을 위해 피라미드형 체계로 구축되어 있다. IANA → 각 대륙별 IP 주소 관리 기관 → 각국의 IP 주소 관리 기관 → ISP 순으로 IP를 할당받으며 ISP에서는 다시 지역별로 IP를 나눈 뒤 계약자(개인이나 회사)에게 IP를 할당해준다. 이렇게 할당받은 IP가 바로 공인 IP이다


### 자동 주소 할당 대신 수동 할당과 충돌

- ip데이터그램을 송수신하기 위해서 4개의 주소가 필요하다. 수신처 mac 주소, 송신처 mac주소, 수신처 ip 주소, 송신처 ip주소.
- 송신처 ip주소를 설정할때 수동(정적)과 자동(동적)으로 설정 할 수 있다.
- 수동으로 하는 방법은 네트워크 관리자가 정한 ip주소를 자신의 컴퓨터에 입력하는 것이다.
- 자동은 DHCP(Dynamic Host configuration protocol)을 써서 할당 받는다.
  - 갖고 있는 네트워크 범위한에서 설정된 ip 주소 풀 중에서 요청한 클라이언트에게 각각 유일한 ip를 할당해준다.
  - 대여 기간이 있다.
  - DCHP동작
    - 클라이언트는 DHCP DISCOVER 메시지를 브로드캐스트한다.
    - DISCOVER를 받은 서버는 할당할 IP 주소를 풀에서 선택해서 그것을 클라이언트에게 브로드캐스트해서 통지한다.
    - 클라이언트는 DOFFER에서 받은 IP주소로 문제가 없으면 DHCP REQUEST를 서버에 브로드캐스트한다.
    - REQUEST를 받은 서버는 문제가 없으면 DHCP ACK를 보낸다. 그때 서브넷 마스크등 옵션 설정도 ACK에 넣어서 보낸다.

#### 충돌 

- 중복 IP 주소 충돌의 일반적인 시나리오
  - 시나리오 1
    - 고정 IP 주소는 프린터 등 네트워크 장치에 대해 정의 됩니다. DHCP 서버를 설치 하는 경우 네트워크 장치  DHCP 클라이언트 컴퓨터 사이의 중복 IP 주소 충돌이 발생할 수 있습니다.
  - 시나리오 2
    - 수동으로 DHCP 서버로 네트워크 연결 실패 시 네트워크 장치 및 컴퓨터에 대 한 고정 IP 주소를 정의합니다. 링크를 다시 다음 될 때 충돌이 발생 합니다. ???

- 해결방법
  - 네트워크 장치에 대해 고정 IP 주소를 정의하는 경우, DHCP 네트워크에서 중복 IP 주소 충돌이 발생할 수 있습니다. 해결 하려면 DHCP 클라이언트 네트워크 장치를 정적 IP 주소로 변환 합니다. 또는 고정 IP 주소를 DHCP 서버에서 DHCP 범위에서 제외할 수 있습니다.


### 브로드캐스트

- 데이터 전송 방법에 3종류가 있다
  - 유니캐스트: 1 대 1 
  - 브로드캐스트: 1 대 전체
  - 멀티캐스트: 1 대 다수

- 위에 DHCP 동작 방식 참고

- 수신처 ip 주소, MAC주소
  - 수신처 IP주소는 내가 알고 있어야 한다.

- 수신처 MAC주소
  - 수신처 IP 주소에 맥 주소를 물어본다. 
  - ARP 테이블에 IP에 맞는 MAC주소가 있으면 바로 돌려준다.
  - 없을 시에 ARP 요청을 한다
    - 네트워크 내의 모든 컴퓨터에 브로드캐스트 해서 해당 MAC주소를 찾는다
  - 그 후에 ARP 테이블에 기재한다

## Future Action

- 오늘 문제 대충 풀려다가 결국에 시간 더 걸렸다. 다음에는 그냥 처음 부터 제대로 하자.

